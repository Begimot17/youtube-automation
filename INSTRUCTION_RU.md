# Инструкция по запуску YouTube Automation (RU)

Система для автоматического создания и публикации видео на YouTube.
Поддерживает генерацию через AI, озвучку, монтаж и загрузку через эмуляцию браузера.

---

## 1. Подготовка

### A. Получение ключей API
Вам понадобятся ключи от сервисов:
1.  **OpenAI API Key** (для сценариев и озвучки): [Ссылка](https://platform.openai.com/api-keys)
2.  **Pexels API Key** (для фоновых видео): [Ссылка](https://www.pexels.com/api/)

Создайте файл `.env` в папке проекта (или скопируйте `.env.example`) и вставьте ключи:
```ini
OPENAI_API_KEY=sk-proj-xxxx...
PEXELS_API_KEY=yyyy...
```

### B. Авторизация YouTube (Cookies)
Чтобы бот мог загружать видео, нужно один раз войти в аккаунт.
**Важно:** Это нужно делать на вашем компьютере (Windows), так как при запуске через Docker окна браузера не будет.

1. Установите зависимости (если еще нет):
   ```bash
   pip install -r requirements.txt
   playwright install chromium
   ```
2. Запустите скрипт входа:
   ```bash
   python src/auth/login.py
   ```
3. Откроется браузер. Войдите в свой Google/YouTube аккаунт.
4. После входа нажмите `Enter` в терминале или просто закройте браузер.
5. Файл с "куками" сохранится в папке `auth/cookies_channel1.json`.

---

## 2. Настройка каналов (Панель Управления)

У вас есть два способа управлять задачами: через **Google Таблицы** (рекомендуется) или через локальный файл.

### Способ 1: Google Таблицы (Control Panel)
1. Создайте Google Таблицу с названием `YouTube-Automation-Control-Panel`.
2. Сделайте следующие заголовки (строка 1):
   `ID`, `Topic`, `Channel`, `Status`, `ResultURL`
3. Получите файл `credentials.json` от Google Service Account (см. гайды Google Cloud Console) и положите его в корень проекта.
4. Дайте доступ к таблице (Share) на email вашего Service Account.

### Способ 2: Локальная папка (Тестовый режим)
Если вы хотите просто загружать готовые видео из папки:
1. Откройте `config/channels.json`.
2. Убедитесь, что `watch_folder` указывает на `input_videos`.
3. Просто кидайте `.mp4` файлы в папку `input_videos` — бот их подхватит.

---

## 3. Запуск через Docker (Рекомендуемый)

Убедитесь, что Docker Desktop запущен.

### Старт всей системы
```bash
docker-compose up --build -d
```
Эта команда запустит два сервиса:
1. **App**: Основной мозг (Python).
2. **N8N**: Оркестратор для сложных сценариев (доступен по `http://localhost:5678`).

*Примечание: При запуске через Docker бот использует "куки", которые вы сохранили на шаге 1.B. Папка `auth/` пробрасывается внутрь контейнера.*

---

## 4. Как пользоваться

### Сценарий А: "Полный автомат" (через Google Таблицы)
1. Откройте вашу таблицу.
2. Добавьте строку:
   - **Topic**: "Интересные факты о космосе"
   - **Status**: "Pending"
3. Система сама увидит новую задачу, сгенерирует сценарий, озвучку, видео, и загрузит на канал (пока загрузка отключена для тестов, статус сменится на `Done`).

### Сценарий Б: "Загрузка готового видео"
1. Положите видео файл в папку `input_videos` на вашем компьютере.
2. Бот (если запущен `scheduler.py` или `uploader.py`) увидит файл и загрузит его.
   *В Docker-версии по умолчанию запущен сервер API. Чтобы запустить "наблюдателя папки", нужно изменить команду в docker-compose или запустить отдельно.*

### Сценарий В: Ручной запуск (Генерация)
Вы можете сгенерировать видео одной командой (без Docker, просто в консоли):
```bash
python src/factory.py --topic "Почему коты мурлычат"
```
Видео появится в папке `output/`.

---

## 5. Интеграция с N8N
1. Зайдите в N8N: `http://localhost:5678`
2. Создайте Workflow.
3. Добавьте узел **HTTP Request**:
   - **Method**: `POST`
   - **URL**: `http://app:8000/generate`
   - **Body**: `JSON`
     ```json
     {
       "topic": "History of Rome",
       "channel": "HistoryChannel"
     }
     ```
4. Запустите. N8N пнёт Python-сервис, и начнется магия.
